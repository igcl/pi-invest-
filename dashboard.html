<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard | Invest+</title>
    
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
</head>
<body class="bg-light">

    <header class="dash-header">
        <div class="container dash-header-content">
            <div class="auth-logo">
                <div class="logo-icon"><i class="fa-solid fa-star"></i></div>
                <span class="logo-text">Invest<span>+</span></span>
            </div>
            <div class="dash-user-actions">
                <div class="level-badge">
                    <i class="fa-solid fa-trophy"></i> N√≠vel <span id="user-level-badge">1</span>
                </div>
                <a href="#" class="btn btn-outline btn-sm">Sair</a>
            </div>
        </div>
    </header>

    <div class="container dash-container">
        
        <div class="welcome-banner">
            <div class="welcome-left">
                <img src="https://cdn-icons-png.flaticon.com/512/847/847969.png" alt="Avatar" class="user-avatar">
                <div>
                    <h1>Ol√°, <span id="user-name">...</span> <span class="wave">üëã</span></h1>
                    <p>Continue sua jornada para o sucesso financeiro</p>
                </div>
            </div>
            <div class="welcome-right">
                <div class="level-info">
                    <span>Progresso do N√≠vel <span id="user-level">1</span></span>
                    <span id="user-xp-text">0 / 1000 XP</span>
                </div>
                <div class="progress-bar-bg">
                    <div class="progress-bar-fill" id="user-xp-bar" style="width: 0%;"></div>
                </div>
                
                <div class="banner-stat-box">
                    <i class="fa-solid fa-wallet"></i>
                    <span>Total Economizado: <strong id="header-total-saved">R$ 0,00</strong></span>
                    <p id="congrats-msg" style="font-size: 0.75rem; color: #d1fae5; margin-top: 4px; display: none;">
                        üéâ Parab√©ns, voc√™ concluiu <span id="congrats-count">0</span> metas!
                    </p>
                </div>
            </div>
        </div>

        <nav class="dash-tabs">
            <button class="tab-btn active" onclick="openTab('overview')"><i class="fa-solid fa-house"></i> Vis√£o Geral</button>
            <button class="tab-btn" onclick="openTab('goals')"><i class="fa-solid fa-bullseye"></i> Metas</button>
            <button class="tab-btn" onclick="openTab('learn')"><i class="fa-solid fa-book-open"></i> Aprender</button>
            <button class="tab-btn" onclick="openTab('achievements')"><i class="fa-solid fa-medal"></i> Conquistas</button>
            <button class="tab-btn" onclick="openTab('profile')"><i class="fa-solid fa-user"></i> Perfil</button>
        </nav>

        <section id="tab-overview" class="tab-content active">
            
            <div class="stats-cards-grid">
                <div class="stat-card green">
                    <div class="stat-header">
                        <i class="fa-solid fa-wallet"></i>
                        <span class="chip">Total Geral</span>
                    </div>
                    <div class="stat-value" id="stat-saved">R$ 0,00</div>
                    <div class="stat-label">Economizado</div>
                </div>

                <div class="stat-card purple">
                    <div class="stat-header">
                        <i class="fa-solid fa-bullseye"></i>
                        <span class="chip">Progresso</span>
                    </div>
                    <div class="stat-value" id="stat-progress">0%</div>
                    <div class="stat-label">M√©dia das metas</div>
                </div>

                <div class="stat-card orange">
                    <div class="stat-header">
                        <i class="fa-solid fa-bolt"></i>
                        <span class="chip">Foco</span>
                    </div>
                    <div class="stat-value" id="stat-streak">0 dias</div>
                    <div class="stat-label">Sequ√™ncia atual</div>
                </div>
            </div>

            <h3 class="section-title">A√ß√µes R√°pidas</h3>
            <div class="quick-actions-grid">
                <div class="action-card">
                    <div class="action-icon text-purple"><i class="fa-solid fa-piggy-bank"></i></div>
                    <h4>Registrar Economia</h4>
                    <span class="xp-badge">+25 XP</span>
                </div>
                <div class="action-card" onclick="openTab('learn')">
                    <div class="action-icon text-blue"><i class="fa-solid fa-book"></i></div>
                    <h4>Continuar Li√ß√£o</h4>
                    <span class="xp-badge">+125 XP</span>
                </div>
                <div class="action-card" onclick="openModal('new-goal')">
                    <div class="action-icon text-green"><i class="fa-solid fa-bullseye"></i></div>
                    <h4>Nova Meta</h4>
                    <span class="xp-badge">+50 XP</span>
                </div>
                <div class="action-card">
                    <div class="action-icon text-orange"><i class="fa-solid fa-chart-line"></i></div>
                    <h4>Ver Progresso</h4>
                    <span class="xp-badge">An√°lises</span>
                </div>
            </div>

            </section>

        <section id="tab-goals" class="tab-content">
            <div class="section-header-row mb-6">
                <div>
                    <h3 class="section-title mb-1">Suas Metas Financeiras</h3>
                    <p class="text-muted text-sm">Acompanhe seu progresso e conquiste seus objetivos</p>
                </div>
                <button class="btn btn-primary btn-sm" onclick="openModal('new-goal')"><i class="fa-solid fa-plus"></i> Nova Meta</button>
            </div>

            <div class="goals-grid" id="goals-container">
                </div>

            <div id="completed-section" style="display: none; margin-top: 3rem; border-top: 2px dashed #E2E8F0; padding-top: 2rem;">
                <div class="section-header-row mb-4">
                    <h3 class="section-title" style="color: #10B981;">
                        <i class="fa-solid fa-check-circle"></i> Metas Conclu√≠das
                    </h3>
                </div>
                <div class="goals-grid" id="completed-goals-container" style="opacity: 0.7;">
                    </div>
            </div>
        </section>

        <section id="tab-learn" class="tab-content">
            <div class="mb-6">
                <h3 class="section-title mb-1">Educa√ß√£o Financeira</h3>
                <p class="text-muted text-sm">Complete li√ß√µes e ganhe XP para subir de n√≠vel</p>
            </div>

            <div class="learn-layout">
                <div class="lessons-list">
                    <div class="lesson-card">
                        <div class="lesson-icon" style="background: #EFF6FF; color: #3B82F6;"><i class="fa-solid fa-play"></i></div>
                        <div class="lesson-info">
                            <h4>O que √© Educa√ß√£o Financeira?</h4>
                            <div class="lesson-meta"><i class="fa-regular fa-clock"></i> 5 min <span class="xp">+50 XP</span></div>
                        </div>
                        <button class="btn btn-primary btn-sm">Come√ßar</button>
                    </div>
                    
                    <div class="lesson-card">
                        <div class="lesson-icon locked"><i class="fa-solid fa-lock"></i></div>
                        <div class="lesson-info">
                            <h4>Criando Seu Or√ßamento</h4>
                            <div class="lesson-meta"><i class="fa-regular fa-clock"></i> 8 min <span class="xp text-orange">+75 XP</span></div>
                        </div>
                        <span class="badge badge-gray text-xs">Bloqueado</span>
                    </div>
                </div>

                <div class="level-sidebar">
                    <div class="level-card-big">
                        <div class="level-icon"><i class="fa-solid fa-medal"></i></div>
                        <h2>N√≠vel <span id="sidebar-level">1</span></h2>
                        <p class="mb-4 text-white/80 text-sm" id="sidebar-xp">0 / 1000 XP</p>
                        <div class="progress-track bg-black/20"><div class="progress-fill bg-white" id="sidebar-xp-bar" style="width: 0%;"></div></div>
                    </div>

                    <div class="dash-card mt-4">
                        <h4 class="font-bold mb-4">Estat√≠sticas</h4>
                        <div class="stat-row flex justify-between mb-3 text-sm">
                            <span class="text-muted">Li√ß√µes completas</span>
                            <span class="font-bold">0/5</span>
                        </div>
                        <div class="stat-row flex justify-between mb-3 text-sm">
                            <span class="text-muted">Tempo total</span>
                            <span class="font-bold">0 min</span>
                        </div>
                        <div class="stat-row flex justify-between text-sm">
                            <span class="text-muted">XP ganho</span>
                            <span class="font-bold text-purple">0 XP</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="tab-achievements" class="tab-content">
            <div class="mb-6">
                <h3 class="section-title mb-1">Suas Conquistas</h3>
                <p class="text-muted text-sm">Desbloqueie conquistas conforme progride</p>
            </div>

            <div class="achievements-grid">
                <div class="achievement-card locked">
                    <div class="achieve-icon"><i class="fa-regular fa-star"></i></div>
                    <h4>Primeira Meta</h4>
                    <span class="badge badge-gray text-xs">Bloqueado</span>
                </div>
                <div class="achievement-card locked">
                    <div class="achieve-icon"><i class="fa-solid fa-piggy-bank"></i></div>
                    <h4>Economizador</h4>
                    <span class="badge badge-gray text-xs">Bloqueado</span>
                </div>
                <div class="achievement-card locked">
                    <div class="achieve-icon"><i class="fa-regular fa-calendar-check"></i></div>
                    <h4>5 Dias Seguidos</h4>
                    <span class="badge badge-gray text-xs">Bloqueado</span>
                </div>
                <div class="achievement-card locked">
                    <div class="achieve-icon"><i class="fa-solid fa-arrow-trend-up"></i></div>
                    <h4>Investidor Iniciante</h4>
                    <span class="badge badge-gray text-xs">Bloqueado</span>
                </div>
            </div>
        </section>

        <section id="tab-profile" class="tab-content">
            <div class="mb-6">
                <h3 class="section-title mb-1">Seu Perfil</h3>
                <p class="text-muted text-sm">Gerencie seus dados e seguran√ßa</p>
            </div>

            <div class="profile-grid">
                <div class="dash-card">
                    <div class="card-header-row mb-4">
                        <div class="icon-box bg-blue-light text-blue">
                            <i class="fa-solid fa-camera"></i>
                        </div>
                        <h4 class="font-bold">Foto de Perfil</h4>
                    </div>
                    <form id="form-update-photo">
                        <div class="avatar-preview-container mb-4">
                            <img src="https://cdn-icons-png.flaticon.com/512/847/847969.png" alt="Avatar Atual" id="current-avatar-preview" class="user-avatar-lg">
                        </div>
                        <div class="input-group">
                            <label>URL da Imagem</label>
                            <div class="input-wrapper">
                                <i class="fa-solid fa-link"></i>
                                <input type="url" id="new-photo-url" placeholder="Cole o link da imagem aqui..." required>
                            </div>
                            <p class="text-xs text-muted mt-2">Dica: Use links do Flaticon ou Imgur.</p>
                        </div>
                        <button type="submit" class="btn btn-primary w-100 mt-3">Atualizar Foto</button>
                    </form>
                </div>

                <div class="dash-card">
                    <div class="card-header-row mb-4">
                        <div class="icon-box bg-purple-light text-purple">
                            <i class="fa-solid fa-lock"></i>
                        </div>
                        <h4 class="font-bold">Seguran√ßa</h4>
                    </div>
                    <form id="form-update-password">
                        <div class="input-group">
                            <label>Senha Atual</label>
                            <div class="input-wrapper">
                                <i class="fa-solid fa-key"></i>
                                <input type="password" id="current-password" placeholder="Para confirmar que √© voc√™" required>
                            </div>
                        </div>
                        <div class="input-group">
                            <label>Nova Senha</label>
                            <div class="input-wrapper">
                                <i class="fa-solid fa-lock"></i>
                                <input type="password" id="new-password" placeholder="M√≠nimo 6 caracteres" required>
                            </div>
                        </div>
                        <button type="submit" class="btn btn-outline w-100 mt-3">Alterar Senha</button>
                    </form>
                </div>
            </div>
        </section>

    </div>

    <div id="modal-new-goal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Criar Nova Meta</h3>
                <button class="btn-close" onclick="closeModal('new-goal')"><i class="fa-solid fa-xmark"></i></button>
            </div>
            <form id="form-new-goal">
                <div class="input-group">
                    <label>Nome da Meta</label>
                    <div class="input-wrapper">
                        <i class="fa-solid fa-pen"></i>
                        <input type="text" id="goal-name" placeholder="Ex: Viagem, PS5..." required>
                    </div>
                </div>
                <div class="input-group">
                    <label>Valor Total (R$)</label>
                    <div class="input-wrapper">
                        <i class="fa-solid fa-dollar-sign"></i>
                        <input type="number" id="goal-target" placeholder="0,00" step="0.01" required>
                    </div>
                </div>
                <div class="input-group">
                    <label>√çcone</label>
                    <div class="icon-selector">
                        <div class="icon-option selected" data-value="fa-piggy-bank" onclick="selectIcon(this)"><i class="fa-solid fa-piggy-bank"></i></div>
                        <div class="icon-option" data-value="fa-plane" onclick="selectIcon(this)"><i class="fa-solid fa-plane"></i></div>
                        <div class="icon-option" data-value="fa-car" onclick="selectIcon(this)"><i class="fa-solid fa-car"></i></div>
                        <div class="icon-option" data-value="fa-gamepad" onclick="selectIcon(this)"><i class="fa-solid fa-gamepad"></i></div>
                        <div class="icon-option" data-value="fa-house" onclick="selectIcon(this)"><i class="fa-solid fa-house"></i></div>
                    </div>
                    <input type="hidden" id="goal-icon" value="fa-piggy-bank">
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-outline" onclick="closeModal('new-goal')">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Criar Meta</button>
                </div>
            </form>
        </div>
    </div>

    <div id="modal-edit-goal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Gerenciar Meta</h3>
                <button class="btn-close" onclick="closeModal('edit-goal')"><i class="fa-solid fa-xmark"></i></button>
            </div>
            
            <form id="form-edit-goal">
                <input type="hidden" id="edit-goal-id">
                <input type="hidden" id="edit-current-val"> 
                
                <div style="background: #F8FAFC; padding: 1rem; border-radius: 0.5rem; margin-bottom: 1.5rem;">
                    <label class="text-sm font-bold mb-2 block" style="display:block; color:#334155;">O que deseja fazer?</label>
                    <div class="flex gap-2 mb-3" style="display: flex; gap: 10px;">
                        <label class="radio-btn" style="flex: 1;">
                            <input type="radio" name="trans-type" value="deposit" checked>
                            <span><i class="fa-solid fa-arrow-up"></i> Depositar</span>
                        </label>
                        <label class="radio-btn" style="flex: 1;">
                            <input type="radio" name="trans-type" value="withdraw">
                            <span><i class="fa-solid fa-arrow-down"></i> Sacar</span>
                        </label>
                    </div>
                    
                    <div class="input-group mb-0">
                        <div class="input-wrapper">
                            <i class="fa-solid fa-money-bill"></i>
                            <input type="number" id="edit-amount" placeholder="Valor (R$)" step="0.01">
                        </div>
                    </div>
                </div>

                <div class="input-group">
                    <label>Alterar Valor Total da Meta</label>
                    <div class="input-wrapper">
                        <i class="fa-solid fa-bullseye"></i>
                        <input type="number" id="edit-target" placeholder="Novo total (Ex: 5000)" step="0.01" required>
                    </div>
                    <p class="text-xs text-muted mt-1">Ajuste o objetivo final se precisar.</p>
                </div>

                <div class="modal-actions">
                    <button type="button" class="btn btn-outline" onclick="closeModal('edit-goal')">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Salvar Altera√ß√µes</button>
                </div>
            </form>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="script.js"></script>
</body>
</html>